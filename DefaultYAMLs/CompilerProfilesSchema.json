{
    "$schema": "http://json-schema.org/draft-07/schema#",
    "title": "Compiler profiles",
    "description": "Compiler profiles configuraion",
    "type": "object",
    "properties": 
    {
        "PreferredProfile": 
        {
            "type": "string",
            "description": "A default compiler/linker profile to be used if not specified while running the build script"
        },
        "CompilerProfiles": 
        {
            "type": "array",
            "description": "List of compiler/linker profiles that instruct how to compile/link",
            "items": 
            {
                "type": "object",
                "properties": 
                {
                    "Name": 
                    {
                        "type": "string",
                        "description": "Name of the compiler profile"
                    },
                    "FileExtensions" : 
                    {
                        "type": "array",
                        "items":
                        {
                            "type":"string"
                        },
                        "uniqueItems": true,
                        "description": "The file extensions associated with the profile"
                    },
                    "Languages":
                    {
                        "type": "array",
                        "items":
                        {
                            "type":"string"
                        },
                        "uniqueItems": true,
                        "description": "The languages supported by the profile"
                    },
                    "SetupSteps" : 
                    {
                        "type": "array",
                        "items":
                        {
                            "type":"string"
                        },
                        "description": "(Optional) Steps in commandline to setup the environment"
                    },
                    "ObjectFileExtensions":
                    {
                        "type": "object",
                        "patternProperties":
                        {
                            "^.*$": { "type": "string" }
                        },
                        "additionalProperties": false,
                        "description": "The file extension for the object files for each platform"
                    },
                    "SharedLibraryExtensions":
                    {
                        "type": "object",
                        "patternProperties":
                        {
                            "^.*$": 
                            {
                                "type": "array",
                                "items":
                                {
                                    "type":"string"
                                }
                            }
                        },
                        "additionalProperties": false,
                        "description": "The file extensions for the shared libraries for each platform"
                    },
                    "StaticLibraryExtensions":
                    {
                        "type": "object",
                        "patternProperties":
                        {
                            "^.*$": 
                            {
                                "type": "array",
                                "items":
                                {
                                    "type":"string"
                                }
                            }
                        },
                        "additionalProperties": false,
                        "description": "The file extensions for the static libraries for each platform"
                    },
                    "DebugSymbolFileExtensions":
                    {
                        "type": "object",
                        "patternProperties":
                        {
                            "^.*$": 
                            {
                                "type": "array",
                                "items":
                                {
                                    "type":"string"
                                }
                            }
                        },
                        "additionalProperties": false,
                        "description": "(Optional) The file extensions for debug symbols to be copied alongside the binary"
                    },
                    "Compiler":
                    {
                        "type": "object",
                        "properties": 
                        {
                            "SetupSteps" : 
                            {
                                "type": "array",
                                "items":
                                {
                                    "type":"string"
                                },
                                "description": "(Optional) Steps in commandline to setup the compiler"
                            },
                            "Executable": 
                            {
                                "type": "string",
                                "description": "Executable to be called"
                            },
                            "DefaultCompileFlags": 
                            {
                                "type": "string",
                                "description": "Default arguments to provide for compilation which can be overriden by the script"
                            },
                            "CompileArgs": 
                            {
                                "type": "string",
                                "description": "The syntax to compile the given file. {CompileFlags}, {InputFile}, {ObjectFile} will be replaced accordingly"
                            }
                        },
                        "required": 
                        [
                            "Executable",
                            "DefaultCompileFlags",
                            "CompileArgs"
                        ],
                        "description": "Specify the compiler settings, so the final flow will be:\n[Setup steps if any] --> {Executable} {CompileArgs}"
                    },
                    "Linker":
                    {
                        "type": "object",
                        "description": "Specify the linker settings, so the final flow will be:\n[Setup steps if any] --> {Executable} {OutputPart} {DependenciesPart}...(for each dependency)",
                        "properties": 
                        {
                            "SetupSteps" : 
                            {
                                "type": "array",
                                "items":
                                {
                                    "type":"string"
                                },
                                "description": "(Optional) Steps in commandline to setup the linker"
                            },
                            "Executable": 
                            {
                                "type": "string",
                                "description": "Executable to be called"
                            },
                            "DefaultLinkFlags": 
                            {
                                "type": "string",
                                "description": "Default arguments to provide for linking dependencies to the binary, which can be overriden by the script"
                            },
                            "LinkerArgs": 
                            {
                                "type": "object",
                                "properties": 
                                {
                                    "OutputPart": 
                                    {
                                        "type": "string",
                                        "description": "Syntax for outputting to the binary. {LinkFlags}, {ProgramName} will be replaced accordingly"
                                    },
                                    "DependenciesPart": 
                                    {
                                        "type": "string",
                                        "description": "Syntax for linking each dependency. {DependencyName} will be replaced accordingly"
                                    }
                                },
                                "required": 
                                [
                                    "OutputPart",
                                    "DependenciesPart"
                                ],
                                "description": "The syntax to link the given file"
                            }
                        },
                        "required": 
                        [
                            "Executable",
                            "DefaultLinkFlags",
                            "LinkerArgs"
                        ]
                    }
                },
                "required": 
                [
                    "Name", 
                    "FileExtensions", 
                    "ObjectFileExtensions", 
                    "SharedLibraryExtensions", 
                    "StaticLibraryExtensions", 
                    "Compiler", 
                    "Linker"
                ],
                "uniqueItems": true
            }
        }
    },
    "required": ["CompilerProfiles"]
}